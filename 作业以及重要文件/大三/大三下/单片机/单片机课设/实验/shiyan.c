#include <reg51.h>
#define uchar unsigned char
	#define uint unsigned int

sbit sh_cp=P3^0;
sbit ds=P3^1;
sbit st_cp=P3^2;

uchar num=6;
uchar code tab[]={

0x00,0x04,0x48,0x04,0x2A,0x42,0x1A,0x22,0x7E,0x15,0x19,0x49,0xA9,0x80,0x40,0x7E,
0xA4,0x00,0x13,0x09,0x0A,0x15,0x26,0x22,0x42,0x42,0x3E,0x04,0x00,0x04,0x00,0x00,/*"黎",0*/

0x00,0x40,0x00,0x20,0x00,0x18,0xFC,0x07,0x44,0x00,0x44,0xFC,0x44,0x44,0x45,0x44,
0x46,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x7C,0xFC,0x00,0x00,0x00,0x00,/*"启",1*/

0x80,0x40,0x40,0x40,0x30,0x42,0x1E,0x42,0x10,0x42,0x10,0x42,0x10,0x42,0xFF,0x7F,
0x10,0x42,0x10,0x42,0x10,0x42,0x10,0x42,0x10,0x42,0x10,0x40,0x00,0x40,0x00,0x00,/*"生",2*/

0x00,0x00,0x00,0x00,0x10,0x20,0x10,0x20,0xF8,0x3F,0x00,0x20,0x00,0x20,0x00,0x00,/*"1",3*/

0x00,0x00,0x70,0x30,0x08,0x28,0x08,0x24,0x08,0x22,0x08,0x21,0xF0,0x30,0x00,0x00,/*"2",4*/

0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",5*/

0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",6*/

0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",7*/
};

uchar code time[]={
0x00,0x00,0x70,0x30,0x08,0x28,0x08,0x24,0x08,0x22,0x08,0x21,0xF0,0x30,0x00,0x00,/*"2",0*/

0x00,0x00,0x00,0x06,0x80,0x05,0x40,0x24,0x30,0x24,0xF8,0x3F,0x00,0x24,0x00,0x24,/*"4",1*/

0x00,0x00,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x00,/*"-",2*/

0x00,0x00,0xE0,0x0F,0x10,0x10,0x08,0x20,0x08,0x20,0x10,0x10,0xE0,0x0F,0x00,0x00,/*"0",3*/

0x00,0x00,0xE0,0x0F,0x10,0x11,0x88,0x20,0x88,0x20,0x90,0x20,0x00,0x1F,0x00,0x00,/*"6",4*/

0x00,0x00,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x00,/*"-",5*/

0x00,0x00,0xE0,0x0F,0x10,0x10,0x08,0x20,0x08,0x20,0x10,0x10,0xE0,0x0F,0x00,0x00,/*"0",6*/

0x00,0x00,0x30,0x18,0x08,0x20,0x08,0x21,0x08,0x21,0x88,0x22,0x70,0x1C,0x00,0x00,/*"3",7*/

0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",8*/
	
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

};
	
void send(uchar dat595);
void delay(uint n);
void disp_word(uint k);
void disp_time(uint i);

main()
{
   while(1)
	 {
		 if (P0^0==1)
		 {	
		 disp_word(0);
		 }
		 if(P0^0==0)
		 {
			 disp_time(0);
		 }
	 }
}

void send(uchar dat595)
{
	uchar dat=dat595;
	uint i;
	for(i=0;i<8;i++)
	{
		dat<<=1;
		ds=CY;
		sh_cp=0;
		sh_cp=1;
	}
}

void delay(uint n)
{
  uint i,j;
	for(i=0;i<n;i++)
	  for(j=0;j<100;j++);
}

void disp_word(uint k)
{
	uchar i,j,m,row;
	uint g;
	for(j=0;j<5;j++)
	{
		row=0x08;
		for(i=0;i<16;i++)
		{
			st_cp=0;
			for(m=6;m>0;m--)
			{
				g=2*i+k*2+m*32-32;
				send(tab[g+1]);
				send(tab[g]);
			}
			P1=row;
			row++;
			st_cp=1;
			delay(1);
		}
	}
}

void disp_time(uint k)
{
	uchar i,j,m,row;
	uint g;
	for(j=0;j<5;j++)
	{
		row=0x08;
		for(i=0;i<16;i++)
		{
			st_cp=0;
			for(m=6;m>0;m--)
			{
				g=2*i+k*2+m*32-32;
				send(time[g+1]);
				send(time[g]);
			}
			P1=row;
			row++;
			st_cp=1;
			delay(1);
		}
	}
}